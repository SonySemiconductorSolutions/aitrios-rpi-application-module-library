"use strict";(self.webpackChunkmodlib_docs=self.webpackChunkmodlib_docs||[]).push([[3693],{8610:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"apps/calculate","title":"Calculate","description":"estimate&#95;angle","source":"@site/_api_versioned_docs/version-1.3.0/apps/calculate.md","sourceDirName":"apps","slug":"/apps/calculate","permalink":"/en/application-module-library/docs/api-reference/apps/calculate","draft":false,"unlisted":false,"tags":[],"version":"1.3.0","sidebarPosition":3,"frontMatter":{"title":"Calculate","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Blur","permalink":"/en/application-module-library/docs/api-reference/apps/blur"},"next":{"title":"Heatmap","permalink":"/en/application-module-library/docs/api-reference/apps/heatmap"}}');var t=s(4848),l=s(8453);const i={title:"Calculate",sidebar_position:3},r=void 0,c={},d=[{value:'<span class="signature-title">estimate_angle</span>',id:"estimate_angle",level:2},{value:'<span class="signature-title">calculate_distance</span>',id:"calculate_distance",level:2},{value:'<span class="signature-title">calculate_distance_matrix</span>',id:"calculate_distance_matrix",level:2},{value:"SpeedCalculator",id:"speedcalculator",level:2},{value:"Attributes",id:"attributes",level:3},{value:"Methods",id:"methods",level:3},{value:'<span class="signature-title">__init__</span>',id:"__init__",level:4},{value:'<span class="signature-title">calculate</span>',id:"calculate",level:4},{value:'<span class="signature-title">get_speed</span>',id:"get_speed",level:4}];function o(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"module-separator","data-content":"Function"}),"\n",(0,t.jsx)(n.h2,{id:"estimate_angle",children:(0,t.jsx)("span",{className:"signature-title",children:"estimate_angle"})}),"\n",(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"estimate_angle("}),"k, focus_points, height, width",(0,t.jsx)("b",{children:")"})]}),"\n",(0,t.jsx)(n.p,{children:"Calculates the angle of the chosen keypoints."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Args:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"k"}),": Array of keypoints."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"focus_points"}),": Indices of the keypoints to calculate the angle between."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"height"}),": Height of the frame."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"width"}),": Width of the frame."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"}),(0,t.jsx)(n.br,{}),"\n","The calculated angle in degrees, or None if any keypoint is at (0.0, 0.0)."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"angle = estimate_angle(keypoints, [0, 1, 2], frame.height, frame.width)  \n"})}),"\n",(0,t.jsx)("div",{className:"module-separator","data-content":"Function"}),"\n",(0,t.jsx)(n.h2,{id:"calculate_distance",children:(0,t.jsx)("span",{className:"signature-title",children:"calculate_distance"})}),"\n",(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"calculate_distance("}),"point1:\xa0Tuple[float,\xa0float], point2:\xa0Tuple[float,\xa0float]",(0,t.jsx)("b",{children:")"})," \u2011> float"]}),"\n",(0,t.jsx)(n.p,{children:"Calculates the distance between 2 given points."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Args:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"point1"})," (Tuple[float,\xa0float]): Tuple of x and y coordinates for a point"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"point2"})," (Tuple[float,\xa0float]): Tuple of x and y coordinates for a point"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," (float)",(0,t.jsx)(n.br,{}),"\n","Euclidean distance between the two points."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"distance = calculate_distance((0.0, 0.0), (1.0, 1.0))  \n"})}),"\n",(0,t.jsx)("div",{className:"module-separator","data-content":"Function"}),"\n",(0,t.jsx)(n.h2,{id:"calculate_distance_matrix",children:(0,t.jsx)("span",{className:"signature-title",children:"calculate_distance_matrix"})}),"\n",(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"calculate_distance_matrix("}),"x:\xa0numpy.ndarray, y:\xa0numpy.ndarray",(0,t.jsx)("b",{children:")"})," \u2011> numpy.ndarray"]}),"\n",(0,t.jsx)(n.p,{children:"Calculates a pairwise distance matrix between points defined by their x and y coordinates."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Args:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"x"})," (numpy.ndarray): Array of x-coordinates for the points."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"y"})," (numpy.ndarray): Array of y-coordinates for the points."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," (numpy.ndarray)",(0,t.jsx)(n.br,{}),"\n","A square matrix where element [i,j] represents the Euclidean distance",(0,t.jsx)(n.br,{}),"\n","between point i and point j. The matrix is symmetric with zeros on the diagonal."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"x = np.array([0, 1, 2])  \ny = np.array([0, 1, 2])  \ndistances = calculate_distance_matrix(x, y)  \n"})}),"\n",(0,t.jsx)("div",{className:"module-separator","data-content":"Class"}),"\n",(0,t.jsx)(n.h2,{id:"speedcalculator",children:"SpeedCalculator"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"SpeedCalculator("}),"region:\xa0List[Tuple[float,\xa0float]]\xa0=\xa0[(0, 0), (1, 0), (1, 1), (0, 1)]",(0,t.jsx)("b",{children:")"})]}),"\nCalculates the speed of a moving objects and holds all tracked information.\nUses bbox centers to calculate the change of distance over time\nFor example, calculate the speed of object like:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"from modlib.apps.calculate import SpeedCalculator\n\nregion = [(0.49, 0.0), (0.51, 0.0), (0.51, 1.0), (0.49, 1.0)]\nspeed = SpeedCalculator(region)\n\ndetections = tracker.update(frame, detections)\nspeed.calculate(frame, detections)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"attributes",children:"Attributes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)("span",{className:"signature-title",children:"region: List[Tuple[float,\xa0float]]"}),"\xa0\xa0\xa0\xa0Points defining the polygon speed area e.g. [(x1, y1), (x2, y2), ...]"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(n.h4,{id:"__init__",children:(0,t.jsx)("span",{className:"signature-title",children:"__init__"})}),"\n",(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"__init__("}),"self, region:\xa0List[Tuple[float,\xa0float]]\xa0=\xa0[(0, 0), (1, 0), (1, 1), (0, 1)]",(0,t.jsx)("b",{children:")"})]}),"\n",(0,t.jsx)(n.p,{children:"Initializes the SpeedCalculator instance with the given region."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Args:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"region"})," (List[Tuple[float,\xa0float]]\xa0=\xa0[(0, 0), (1, 0), (1, 1), (0, 1)]): Points defining the polygon speed area. Default is [(0, 0), (1, 0), (1, 1), (0, 1)]."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Raises:"}),(0,t.jsx)(n.br,{}),"\n","ValueError: If the region is not defined by exactly 4 points or if any point is not a tuple of 2 values."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"region = [(0.49, 0.0), (0.51, 0.0), (0.51, 1.0), (0.49, 1.0)]  \nspeed_calculator = SpeedCalculator(region)  \n"})}),"\n",(0,t.jsx)(n.h4,{id:"calculate",children:(0,t.jsx)("span",{className:"signature-title",children:"calculate"})}),"\n",(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"calculate("}),"self, frame:\xa0",(0,t.jsx)(n.a,{href:"../devices/frame#frame",children:"Frame"}),", detections:\xa0",(0,t.jsx)(n.a,{href:"../models/results#detections",children:"Detections"}),(0,t.jsx)("b",{children:")"})]}),"\n",(0,t.jsxs)(n.p,{children:["Calculates the speed of detections by calculating the distance traveled over time using Detection's bboxes.",(0,t.jsx)(n.br,{}),"\n","While also storing tracked historic information to calculate the average speed in a given area."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Args:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"frame"})," (",(0,t.jsx)(n.a,{href:"../devices/frame#frame",children:"Frame"}),"): The current frame from camera"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"detections"})," (",(0,t.jsx)(n.a,{href:"../models/results#detections",children:"Detections"}),"): The set of Detections to check if the are in defined area."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"speed_calculator.calculate(frame, detections)  \n"})}),"\n",(0,t.jsx)(n.h4,{id:"get_speed",children:(0,t.jsx)("span",{className:"signature-title",children:"get_speed"})}),"\n",(0,t.jsxs)("div",{className:"signature",children:[(0,t.jsx)("b",{children:"get_speed("}),"self, t:\xa0int, average:\xa0bool\xa0=\xa0False",(0,t.jsx)("b",{children:")"})," \u2011> float\xa0|\xa0None"]}),"\n",(0,t.jsx)(n.p,{children:"Get speed by tracker ID."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Args:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"t"})," (int): Tracker ID to get speed for."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"average"})," (bool\xa0=\xa0False): Indicates whether to return the average or instantaneous speed. Default is False."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Returns:"})," (float\xa0|\xa0None)",(0,t.jsx)(n.br,{}),"\n","Speed value in pixels per second, or None if the tracker ID is invalid (-1) or not found."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"speed = speed_calculator.get_speed(t, average=True)  \n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var a=s(6540);const t={},l=a.createContext(t);function i(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);